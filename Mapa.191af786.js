import{b as L,u as gt,t as _t,o as U}from"./chunks/jsxRuntime.module.44d98b0f.js";import{d as Mt}from"./chunks/preact.module.7d28e569.js";import{T as wt}from"./chunks/hooks.module.a05e4479.js";function r(u,c,d){return c in u?Object.defineProperty(u,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):u[c]=d,u}function St(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,K(u,c)}function K(u,c){return K=Object.setPrototypeOf||function(w,l){return w.__proto__=l,w},K(u,c)}function o(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function Tt(u,c){var d;return function(){for(var w=arguments.length,l=new Array(w),p=0;p<w;p++)l[p]=arguments[p];var g=this;clearTimeout(d),d=setTimeout(function(){return u.apply(g,l)},c)}}function $(u,c){for(;u;){if(u.classList&&u.classList.contains(c))return!0;u=u.parentElement}return!1}function et(u){var c=u.getBoundingClientRect();return{x:c.left,y:c.top}}function xt(u,c,d){var w=String.fromCharCode(97+(u+c+d)%3);return"https://"+w+".tile.openstreetmap.org/"+d+"/"+u+"/"+c+".png"}var V=300,Et=1500,bt=150,Ct=40,q=2,Q=300,Zt=60,Dt=300,Lt=300,y=function(){return!0},Y=function(c,d){return(c+180)/360*Math.pow(2,d)},N=function(c,d){return(1-Math.log(Math.tan(c*Math.PI/180)+1/Math.cos(c*Math.PI/180))/Math.PI)/2*Math.pow(2,d)};function z(u,c){return u/Math.pow(2,c)*360-180}function R(u,c){var d=Math.PI-2*Math.PI*u/Math.pow(2,c);return 180/Math.PI*Math.atan(.5*(Math.exp(d)-Math.exp(-d)))}function A(u,c){var d=et(u);return[c.clientX-d.x,c.clientY-d.y]}function At(u){return u*(2-u)}var H=[R(Math.pow(2,10),10),R(0,10),z(0,10),z(Math.pow(2,10),10)],G=typeof window<"u",W=G&&window.performance&&window.performance.now?function(){return window.performance.now()}:function(){var u=new Date().getTime();return function(){return new Date().getTime()-u}}(),j=function(c){return G?(window.requestAnimationFrame||window.setTimeout)(c):(c(new Date().getTime()),null)},J=function(c){return G&&c?(window.cancelAnimationFrame||window.clearTimeout)(c):!1};function tt(u,c,d,w,l){return!u||u.length===0?"":u.map(function(p){return c(d,w,l,p)+(p===1?"":" "+p+"x")}).join(", ")}var Wt=function(c){var d=c.tile,w=c.tileLoaded;return L.createElement("img",{src:d.url,srcSet:d.srcSet,width:d.width,height:d.height,loading:"lazy",onLoad:w,alt:"",style:{position:"absolute",left:d.left,top:d.top,willChange:"transform",transformOrigin:"top left",opacity:1}})},nt=function(u){St(c,u);function c(w){var l,p,g,x,_,C,T,M,t;return t=u.call(this,w)||this,r(o(t),"_containerRef",void 0),r(o(t),"_mousePosition",void 0),r(o(t),"_loadTracker",void 0),r(o(t),"_dragStart",null),r(o(t),"_mouseDown",!1),r(o(t),"_moveEvents",[]),r(o(t),"_lastClick",null),r(o(t),"_lastTap",null),r(o(t),"_lastWheel",null),r(o(t),"_touchStartPixel",null),r(o(t),"_touchStartMidPoint",null),r(o(t),"_touchStartDistance",null),r(o(t),"_secondTouchEnd",null),r(o(t),"_warningClearTimeout",null),r(o(t),"_isAnimating",!1),r(o(t),"_animationStart",null),r(o(t),"_animationEnd",null),r(o(t),"_zoomStart",null),r(o(t),"_centerTarget",null),r(o(t),"_zoomTarget",null),r(o(t),"_zoomAround",null),r(o(t),"_animFrame",null),r(o(t),"_boundsSynced",!1),r(o(t),"_minMaxCache",null),r(o(t),"_lastZoom",void 0),r(o(t),"_lastCenter",void 0),r(o(t),"_centerStart",void 0),r(o(t),"_resizeObserver",null),r(o(t),"updateWidthHeight",function(){if(t._containerRef){var e=t._containerRef.getBoundingClientRect();if(e&&e.width>0&&e.height>0)return t.setState({width:e.width,height:e.height}),!0}return!1}),r(o(t),"wa",function(){var e;return(e=window).addEventListener.apply(e,arguments)}),r(o(t),"wr",function(){var e;return(e=window).removeEventListener.apply(e,arguments)}),r(o(t),"bindMouseEvents",function(){t.wa("mousedown",t.handleMouseDown),t.wa("mouseup",t.handleMouseUp),t.wa("mousemove",t.handleMouseMove)}),r(o(t),"bindTouchEvents",function(){t.wa("touchstart",t.handleTouchStart,{passive:!1}),t.wa("touchmove",t.handleTouchMove,{passive:!1}),t.wa("touchend",t.handleTouchEnd,{passive:!1})}),r(o(t),"unbindMouseEvents",function(){t.wr("mousedown",t.handleMouseDown),t.wr("mouseup",t.handleMouseUp),t.wr("mousemove",t.handleMouseMove)}),r(o(t),"unbindTouchEvents",function(){t.wr("touchstart",t.handleTouchStart),t.wr("touchmove",t.handleTouchMove),t.wr("touchend",t.handleTouchEnd)}),r(o(t),"bindResizeEvent",function(){t.wa("resize",t.updateWidthHeight)}),r(o(t),"unbindResizeEvent",function(){t.wr("resize",t.updateWidthHeight)}),r(o(t),"bindWheelEvent",function(){t._containerRef&&t._containerRef.addEventListener("wheel",t.handleWheel,{passive:!1})}),r(o(t),"unbindWheelEvent",function(){t._containerRef&&t._containerRef.removeEventListener("wheel",t.handleWheel)}),r(o(t),"setCenterZoomTarget",function(e,n,a,i,s){if(a===void 0&&(a=!1),i===void 0&&(i=null),s===void 0&&(s=V),t.props.animate&&(!a||t.distanceInScreens(e,n,t.state.center,t.state.zoom)<=t.props.animateMaxScreens)){if(t._isAnimating){J(t._animFrame);var h=t.animationStep(W()),m=h.centerStep,v=h.zoomStep;t._centerStart=m,t._zoomStart=v}else t._isAnimating=!0,t._centerStart=t.limitCenterAtZoom([t._lastCenter[0],t._lastCenter[1]],t._lastZoom),t._zoomStart=t._lastZoom,t.onAnimationStart();t._animationStart=W(),t._animationEnd=t._animationStart+s,i?(t._zoomAround=i,t._centerTarget=t.calculateZoomCenter(t._lastCenter,i,t._lastZoom,n)):(t._zoomAround=null,t._centerTarget=e),t._zoomTarget=n,t._animFrame=j(t.animate)}else if(t.stopAnimating(),i){var f=t.calculateZoomCenter(t._lastCenter,i,t._lastZoom,n);t.setCenterZoom(f,n,a)}else t.setCenterZoom(e||t.state.center,n,a)}),r(o(t),"setCenterZoomForChildren",function(e,n){t.setCenterZoomTarget(e||t.state.center,n||t.state.zoom,!0)}),r(o(t),"distanceInScreens",function(e,n,a,i){var s=t.state,h=s.width,m=s.height,v=t.latLngToPixel(a,a,i),f=t.latLngToPixel(e,a,i),S=t.latLngToPixel(a,a,n),b=t.latLngToPixel(e,a,n),E=(Math.abs(v[0]-f[0])+Math.abs(S[0]-b[0]))/2/h,D=(Math.abs(v[1]-f[1])+Math.abs(S[1]-b[1]))/2/m;return Math.sqrt(E*E+D*D)}),r(o(t),"animationStep",function(e){if(!t._animationEnd||!t._animationStart||!t._zoomTarget||!t._zoomStart||!t._centerStart||!t._centerTarget)return{centerStep:t.state.center,zoomStep:t.state.zoom};var n=t._animationEnd-t._animationStart,a=Math.max(e-t._animationStart,0),i=At(a/n),s=(t._zoomTarget-t._zoomStart)*i,h=t._zoomStart+s;if(t._zoomAround){var m=t.calculateZoomCenter(t._centerStart,t._zoomAround,t._zoomStart,h);return{centerStep:m,zoomStep:h}}else{var v=[t._centerStart[0]+(t._centerTarget[0]-t._centerStart[0])*i,t._centerStart[1]+(t._centerTarget[1]-t._centerStart[1])*i];return{centerStep:v,zoomStep:h}}}),r(o(t),"animate",function(e){if(!t._animationEnd||e>=t._animationEnd)t._isAnimating=!1,t.setCenterZoom(t._centerTarget,t._zoomTarget,!0),t.onAnimationStop();else{var n=t.animationStep(e),a=n.centerStep,i=n.zoomStep;t.setCenterZoom(a,i),t._animFrame=j(t.animate)}}),r(o(t),"stopAnimating",function(){t._isAnimating&&(t._isAnimating=!1,t.onAnimationStop(),J(t._animFrame))}),r(o(t),"limitCenterAtZoom",function(e,n){var a=t.getBoundsMinMax(n||t.state.zoom);return[Math.max(Math.min(!e||isNaN(e[0])?t.state.center[0]:e[0],a[1]),a[0]),Math.max(Math.min(!e||isNaN(e[1])?t.state.center[1]:e[1],a[3]),a[2])]}),r(o(t),"onAnimationStart",function(){t.props.onAnimationStart&&t.props.onAnimationStart()}),r(o(t),"onAnimationStop",function(){t.props.onAnimationStop&&t.props.onAnimationStop()}),r(o(t),"setCenterZoom",function(e,n,a){a===void 0&&(a=!1);var i=t.limitCenterAtZoom(e,n);if(n&&Math.round(t.state.zoom)!==Math.round(n)){var s=t.tileValues(t.state),h=t.tileValues({center:i,zoom:n,width:t.state.width,height:t.state.height}),m=t.state.oldTiles;t.setState({oldTiles:m.filter(function(Z){return Z.roundedZoom!==s.roundedZoom}).concat(s)},y);for(var v={},f=h.tileMinX;f<=h.tileMaxX;f++)for(var S=h.tileMinY;S<=h.tileMaxY;S++){var b=f+"-"+S+"-"+h.roundedZoom;v[b]=!1}t._loadTracker=v}t.setState({center:i,zoom:n||t.state.zoom},y);var E=t.props.zoom?t.props.zoom:t._lastZoom,D=t.props.center?t.props.center:t._lastCenter;n&&(a||Math.abs(E-n)>.001||Math.abs(D[0]-i[0])>1e-5||Math.abs(D[1]-i[1])>1e-5)&&(t._lastZoom=n,t._lastCenter=[].concat(i),t.syncToProps(i,n))}),r(o(t),"getBoundsMinMax",function(e){if(t.props.limitBounds==="center")return H;var n=t.state,a=n.width,i=n.height;if(t._minMaxCache&&t._minMaxCache[0]===e&&t._minMaxCache[1]===a&&t._minMaxCache[2]===i)return t._minMaxCache[3];var s=Math.pow(2,e)*256,h=a>s?0:z(a/512,e),m=i>s?0:R(Math.pow(2,e)-i/512,e),v=a>s?0:z(Math.pow(2,e)-a/512,e),f=i>s?0:R(i/512,e),S=[m,f,h,v];return t._minMaxCache=[e,a,i,S],S}),r(o(t),"tileLoaded",function(e){if(t._loadTracker&&e in t._loadTracker){t._loadTracker[e]=!0;var n=Object.values(t._loadTracker).filter(function(a){return!a}).length;n===0&&t.setState({oldTiles:[]},y)}}),r(o(t),"handleTouchStart",function(e){if(!!t._containerRef&&!(e.target&&$(e.target,"pigeon-drag-block"))){if(e.touches.length===1){var n=e.touches[0],a=A(t._containerRef,n);if(t.coordsInside(a)&&(t._touchStartPixel=[a],!t.props.twoFingerDrag))if(t.stopAnimating(),t._lastTap&&W()-t._lastTap<Q){e.preventDefault();var i=t.pixelToLatLng(t._touchStartPixel[0]);t.setCenterZoomTarget(null,Math.max(t.props.minZoom,Math.min(t.state.zoom+1,t.props.maxZoom)),!1,i)}else t._lastTap=W(),t.trackMoveEvents(a)}else if(e.touches.length===2&&t._touchStartPixel){e.preventDefault(),t.stopTrackingMoveEvents(),(t.state.pixelDelta||t.state.zoomDelta)&&t.sendDeltaChange();var s=A(t._containerRef,e.touches[0]),h=A(t._containerRef,e.touches[1]);t._touchStartPixel=[s,h],t._touchStartMidPoint=[(s[0]+h[0])/2,(s[1]+h[1])/2],t._touchStartDistance=Math.sqrt(Math.pow(s[0]-h[0],2)+Math.pow(s[1]-h[1],2))}}}),r(o(t),"handleTouchMove",function(e){if(!t._containerRef){t._touchStartPixel=null;return}if(e.touches.length===1&&t._touchStartPixel){var n=e.touches[0],a=A(t._containerRef,n);t.props.twoFingerDrag?t.coordsInside(a)&&t.showWarning("fingers"):(e.preventDefault(),t.trackMoveEvents(a),t.setState({pixelDelta:[a[0]-t._touchStartPixel[0][0],a[1]-t._touchStartPixel[0][1]]},y))}else if(e.touches.length===2&&t._touchStartPixel&&t._touchStartMidPoint&&t._touchStartDistance){var i=t.state,s=i.width,h=i.height,m=i.zoom;e.preventDefault();var v=A(t._containerRef,e.touches[0]),f=A(t._containerRef,e.touches[1]),S=[(v[0]+f[0])/2,(v[1]+f[1])/2],b=[S[0]-t._touchStartMidPoint[0],S[1]-t._touchStartMidPoint[1]],E=Math.sqrt(Math.pow(v[0]-f[0],2)+Math.pow(v[1]-f[1],2)),D=Math.max(t.props.minZoom,Math.min(t.props.maxZoom,m+Math.log2(E/t._touchStartDistance)))-m,Z=Math.pow(2,D),P=[(s/2-S[0])*(Z-1),(h/2-S[1])*(Z-1)];t.setState({zoomDelta:D,pixelDelta:[P[0]+b[0]*Z,P[1]+b[1]*Z]},y)}}),r(o(t),"handleTouchEnd",function(e){if(!t._containerRef){t._touchStartPixel=null;return}if(t._touchStartPixel){var n=t.props,a=n.zoomSnap,i=n.twoFingerDrag,s=n.minZoom,h=n.maxZoom,m=t.state.zoomDelta,v=t.sendDeltaChange(),f=v.center,S=v.zoom;if(e.touches.length===0)if(i)t.clearWarning();else{var b=t._touchStartPixel[0],E=A(t._containerRef,e.changedTouches[0]);(Math.abs(b[0]-E[0])>q||Math.abs(b[1]-E[1])>q)&&(!t._secondTouchEnd||W()-t._secondTouchEnd>Dt)&&(e.preventDefault(),t.throwAfterMoving(E,f,S)),t._touchStartPixel=null,t._secondTouchEnd=null}else if(e.touches.length===1){e.preventDefault();var D=A(t._containerRef,e.touches[0]);if(t._secondTouchEnd=W(),t._touchStartPixel=[D],t.trackMoveEvents(D),a){var Z=t._touchStartMidPoint?t.pixelToLatLng(t._touchStartMidPoint):t.state.center,P;i&&Math.round(t.state.zoom)===Math.round(t.state.zoom+m)?P=Math.round(t.state.zoom):P=m>0?Math.ceil(t.state.zoom):Math.floor(t.state.zoom);var X=Math.max(s,Math.min(P,h));t.setCenterZoomTarget(Z,X,!1,Z)}}}}),r(o(t),"handleMouseDown",function(e){if(!!t._containerRef){var n=A(t._containerRef,e);if(e.button===0&&(!e.target||!$(e.target,"pigeon-drag-block"))&&t.coordsInside(n))if(t.stopAnimating(),e.preventDefault(),t._lastClick&&W()-t._lastClick<Q){if(!$(e.target,"pigeon-click-block")){var a=t.pixelToLatLng(t._mousePosition||n);t.setCenterZoomTarget(null,Math.max(t.props.minZoom,Math.min(t.state.zoom+1,t.props.maxZoom)),!1,a)}}else t._lastClick=W(),t._mouseDown=!0,t._dragStart=n,t.trackMoveEvents(n)}}),r(o(t),"handleMouseMove",function(e){!t._containerRef||(t._mousePosition=A(t._containerRef,e),t._mouseDown&&t._dragStart&&(t.trackMoveEvents(t._mousePosition),t.setState({pixelDelta:[t._mousePosition[0]-t._dragStart[0],t._mousePosition[1]-t._dragStart[1]]},y)))}),r(o(t),"handleMouseUp",function(e){if(!t._containerRef){t._mouseDown=!1;return}var n=t.state.pixelDelta;if(t._mouseDown){t._mouseDown=!1;var a=A(t._containerRef,e);if(t.props.onClick&&(!e.target||!$(e.target,"pigeon-click-block"))&&(!n||Math.abs(n[0])+Math.abs(n[1])<=q)){var i=t.pixelToLatLng(a);t.props.onClick({event:e,latLng:i,pixel:a}),t.setState({pixelDelta:void 0},y)}else{var s=t.sendDeltaChange(),h=s.center,m=s.zoom;t.throwAfterMoving(a,h,m)}}}),r(o(t),"stopTrackingMoveEvents",function(){t._moveEvents=[]}),r(o(t),"trackMoveEvents",function(e){var n=W();(t._moveEvents.length===0||n-t._moveEvents[t._moveEvents.length-1].timestamp>40)&&(t._moveEvents.push({timestamp:n,coords:e}),t._moveEvents.length>2&&t._moveEvents.shift())}),r(o(t),"throwAfterMoving",function(e,n,a){var i=t.state,s=i.width,h=i.height,m=t.props.animate,v=W(),f=t._moveEvents.shift();if(f&&m){var S=Math.max(v-f.timestamp,1),b=[(e[0]-f.coords[0])/S*120,(e[1]-f.coords[1])/S*120],E=Math.sqrt(b[0]*b[0]+b[1]*b[1]);if(E>Ct){var D=Math.sqrt(s*s+h*h),Z=Et*E/D,P=z(Y(n[1],a)-b[0]/256,a),X=R(N(n[0],a)-b[1]/256,a);t.setCenterZoomTarget([X,P],a,!1,null,Z)}}t.stopTrackingMoveEvents()}),r(o(t),"sendDeltaChange",function(){var e=t.state,n=e.center,a=e.zoom,i=e.pixelDelta,s=e.zoomDelta,h=n[0],m=n[1];return(i||s!==0)&&(m=z(Y(n[1],a+s)-(i?i[0]/256:0),a+s),h=R(N(n[0],a+s)-(i?i[1]/256:0),a+s),t.setCenterZoom([h,m],a+s)),t.setState({pixelDelta:void 0,zoomDelta:0},y),{center:t.limitCenterAtZoom([h,m],a+s),zoom:a+s}}),r(o(t),"getBounds",function(e,n){e===void 0&&(e=t.state.center),n===void 0&&(n=t.zoomPlusDelta());var a=t.state,i=a.width,s=a.height;return{ne:t.pixelToLatLng([i-1,0],e,n),sw:t.pixelToLatLng([0,s-1],e,n)}}),r(o(t),"syncToProps",function(e,n){e===void 0&&(e=t.state.center),n===void 0&&(n=t.state.zoom);var a=t.props.onBoundsChanged;if(a){var i=t.getBounds(e,n);a({center:e,zoom:n,bounds:i,initial:!t._boundsSynced}),t._boundsSynced=!0}}),r(o(t),"handleWheel",function(e){var n=t.props,a=n.mouseEvents,i=n.metaWheelZoom,s=n.zoomSnap,h=n.animate;if(!!a)if(!i||e.metaKey||e.ctrlKey){e.preventDefault();var m=-e.deltaY/bt;if(!s&&t._zoomTarget){var v=t._zoomTarget-t.state.zoom;t.zoomAroundMouse(m+v,e)}else h?t.zoomAroundMouse(m,e):(!t._lastWheel||W()-t._lastWheel>V)&&(t._lastWheel=W(),t.zoomAroundMouse(m,e))}else t.showWarning("wheel")}),r(o(t),"showWarning",function(e){(!t.state.showWarning||t.state.warningType!==e)&&t.setState({showWarning:!0,warningType:e}),t._warningClearTimeout&&window.clearTimeout(t._warningClearTimeout),t._warningClearTimeout=window.setTimeout(t.clearWarning,Lt)}),r(o(t),"clearWarning",function(){t.state.showWarning&&t.setState({showWarning:!1})}),r(o(t),"zoomAroundMouse",function(e,n){if(!!t._containerRef){var a=t.state.zoom,i=t.props,s=i.minZoom,h=i.maxZoom,m=i.zoomSnap;if(t._mousePosition=A(t._containerRef,n),!(!t._mousePosition||a===s&&e<0||a===h&&e>0)){var v=t.pixelToLatLng(t._mousePosition),f=a+e;m&&(f=e<0?Math.floor(f):Math.ceil(f)),f=Math.max(s,Math.min(f,h)),t.setCenterZoomTarget(null,f,!1,v)}}}),r(o(t),"zoomPlusDelta",function(){return t.state.zoom+t.state.zoomDelta}),r(o(t),"pixelToLatLng",function(e,n,a){n===void 0&&(n=t.state.center),a===void 0&&(a=t.zoomPlusDelta());var i=t.state,s=i.width,h=i.height,m=i.pixelDelta,v=[(e[0]-s/2-(m?m[0]:0))/256,(e[1]-h/2-(m?m[1]:0))/256],f=Y(n[1],a)+v[0],S=N(n[0],a)+v[1];return[Math.max(H[0],Math.min(H[1],R(S,a))),Math.max(H[2],Math.min(H[3],z(f,a)))]}),r(o(t),"latLngToPixel",function(e,n,a){n===void 0&&(n=t.state.center),a===void 0&&(a=t.zoomPlusDelta());var i=t.state,s=i.width,h=i.height,m=i.pixelDelta,v=Y(n[1],a),f=N(n[0],a),S=Y(e[1],a),b=N(e[0],a);return[(S-v)*256+s/2+(m?m[0]:0),(b-f)*256+h/2+(m?m[1]:0)]}),r(o(t),"calculateZoomCenter",function(e,n,a,i){var s=t.state,h=s.width,m=s.height,v=t.latLngToPixel(n,e,a),f=t.latLngToPixel(n,e,i),S=t.pixelToLatLng([h/2+f[0]-v[0],m/2+f[1]-v[1]],e,i);return t.limitCenterAtZoom(S,i)}),r(o(t),"setRef",function(e){t._containerRef=e}),t.syncToProps=Tt(t.syncToProps,Zt),t._lastZoom=(l=(p=w.defaultZoom)!==null&&p!==void 0?p:w.zoom)!==null&&l!==void 0?l:14,t._lastCenter=(g=(x=w.defaultCenter)!==null&&x!==void 0?x:w.center)!==null&&g!==void 0?g:[0,0],t.state={zoom:t._lastZoom,center:t._lastCenter,width:(_=(C=w.width)!==null&&C!==void 0?C:w.defaultWidth)!==null&&_!==void 0?_:-1,height:(T=(M=w.height)!==null&&M!==void 0?M:w.defaultHeight)!==null&&T!==void 0?T:-1,zoomDelta:0,pixelDelta:void 0,oldTiles:[],showWarning:!1,warningType:void 0},t}var d=c.prototype;return d.componentDidMount=function(){var l=this;this.props.mouseEvents&&this.bindMouseEvents(),this.props.touchEvents&&this.bindTouchEvents(),(!this.props.width||!this.props.height)&&(this.updateWidthHeight()||j(this.updateWidthHeight),this.bindResizeEvent()),this.bindWheelEvent(),this.syncToProps(),typeof window.ResizeObserver<"u"&&(this._resizeObserver=new window.ResizeObserver(function(){l.updateWidthHeight()}),this._resizeObserver.observe(this._containerRef))},d.componentWillUnmount=function(){this.props.mouseEvents&&this.unbindMouseEvents(),this.props.touchEvents&&this.unbindTouchEvents(),this.unbindWheelEvent(),(!this.props.width||!this.props.height)&&this.unbindResizeEvent(),this._resizeObserver&&this._resizeObserver.disconnect()},d.componentDidUpdate=function(l){var p;if(this.props.mouseEvents!==l.mouseEvents&&(this.props.mouseEvents?this.bindMouseEvents():this.unbindMouseEvents()),this.props.touchEvents!==l.touchEvents&&(this.props.touchEvents?this.bindTouchEvents():this.unbindTouchEvents()),this.props.width&&this.props.width!==l.width&&this.setState({width:this.props.width}),this.props.height&&this.props.height!==l.height&&this.setState({height:this.props.height}),!(!this.props.center&&!this.props.zoom)&&!((!this.props.center||this.props.center[0]===(l==null||(p=l.center)===null||p===void 0?void 0:p[0])&&this.props.center[1]===l.center[1])&&this.props.zoom===l.zoom)){var g=this._isAnimating?this._centerTarget:this.state.center,x=this._isAnimating?this._zoomTarget:this.state.zoom;if(g&&x){var _,C,T=(_=this.props.center)!==null&&_!==void 0?_:g,M=(C=this.props.zoom)!==null&&C!==void 0?C:x;(Math.abs(M-x)>.001||Math.abs(T[0]-g[0])>1e-4||Math.abs(T[1]-g[1])>1e-4)&&this.setCenterZoomTarget(T,M,!0)}}},d.coordsInside=function(l){var p=this.state,g=p.width,x=p.height;if(l[0]<0||l[1]<0||l[0]>=g||l[1]>=x)return!1;var _=this._containerRef;if(_){var C=et(_),T=document.elementFromPoint(l[0]+C.x,l[1]+C.y);return _===T||_.contains(T)}else return!1},d.tileValues=function(l){var p=l.center,g=l.zoom,x=l.pixelDelta,_=l.zoomDelta,C=l.width,T=l.height,M=Math.round(g+(_||0)),t=g+(_||0)-M,e=Math.pow(2,t),n=C/e,a=T/e,i=Y(p[1],M)-(x?x[0]/256/e:0),s=N(p[0],M)-(x?x[1]/256/e:0),h=n/2/256,m=a/2/256,v=Math.floor(i-h),f=Math.floor(i+h),S=Math.floor(s-m),b=Math.floor(s+m);return{tileMinX:v,tileMaxX:f,tileMinY:S,tileMaxY:b,tileCenterX:i,tileCenterY:s,roundedZoom:M,zoomDelta:_||0,scaleWidth:n,scaleHeight:a,scale:e}},d.renderTiles=function(){for(var l=this,p=this.state,g=p.oldTiles,x=p.width,_=p.height,C=this.props.dprs,T=this.props.provider||xt,M=this.tileValues(this.state),t=M.tileMinX,e=M.tileMaxX,n=M.tileMinY,a=M.tileMaxY,i=M.tileCenterX,s=M.tileCenterY,h=M.roundedZoom,m=M.scaleWidth,v=M.scaleHeight,f=M.scale,S=[],b=0;b<g.length;b++){var E=g[b],D=E.roundedZoom-h;if(!(Math.abs(D)>4||D===0))for(var Z=1/Math.pow(2,D),P=-(t-E.tileMinX*Z)*256,X=-(n-E.tileMinY*Z)*256,at=Math.max(E.tileMinX,0),it=Math.max(E.tileMinY,0),rt=Math.min(E.tileMaxX,Math.pow(2,E.roundedZoom)-1),ot=Math.min(E.tileMaxY,Math.pow(2,E.roundedZoom)-1),O=at;O<=rt;O++)for(var k=it;k<=ot;k++)S.push({key:O+"-"+k+"-"+E.roundedZoom,url:T(O,k,E.roundedZoom),srcSet:tt(C,T,O,k,E.roundedZoom),left:P+(O-E.tileMinX)*256*Z,top:X+(k-E.tileMinY)*256*Z,width:256*Z,height:256*Z,active:!1})}for(var st=Math.max(t,0),lt=Math.max(n,0),ht=Math.min(e,Math.pow(2,h)-1),ut=Math.min(a,Math.pow(2,h)-1),I=st;I<=ht;I++)for(var F=lt;F<=ut;F++)S.push({key:I+"-"+F+"-"+h,url:T(I,F,h),srcSet:tt(C,T,I,F,h),left:(I-t)*256,top:(F-n)*256,width:256,height:256,active:!0});var ct={width:m,height:v,position:"absolute",top:"calc((100% - "+_+"px) / 2)",left:"calc((100% - "+x+"px) / 2)",overflow:"hidden",willChange:"transform",transform:"scale("+f+", "+f+")",transformOrigin:"top left"},mt=this.props.boxClassname||"pigeon-tiles-box",dt=-((i-t)*256-m/2),ft=-((s-n)*256-v/2),pt={position:"absolute",width:(e-t+1)*256,height:(a-n+1)*256,willChange:"transform",transform:"translate("+dt+"px, "+ft+"px)"},vt=this.props.tileComponent;return L.createElement("div",{style:ct,className:mt},L.createElement("div",{className:"pigeon-tiles",style:pt},S.map(function(B){return L.createElement(vt,{key:B.key,tile:B,tileLoaded:function(){return l.tileLoaded(B.key)}})})))},d.renderOverlays=function(){var l=this,p=this.state,g=p.width,x=p.height,_=p.center,C={bounds:this.getBounds(),zoom:this.zoomPlusDelta(),center:_,width:g,height:x},T=L.Children.map(this.props.children,function(t){if(!t)return null;if(!L.isValidElement(t))return t;var e=t.props,n=e.anchor,a=e.position,i=e.offset,s=l.latLngToPixel(n||a||_);return L.cloneElement(t,{left:s[0]-(i?i[0]:0),top:s[1]-(i?i[1]:0),latLngToPixel:l.latLngToPixel,pixelToLatLng:l.pixelToLatLng,setCenterZoom:l.setCenterZoomForChildren,mapProps:l.props,mapState:C})}),M={position:"absolute",width:g,height:x,top:"calc((100% - "+x+"px) / 2)",left:"calc((100% - "+g+"px) / 2)"};return L.createElement("div",{className:"pigeon-overlays",style:M},T)},d.renderAttribution=function(){var l=this.props,p=l.attribution,g=l.attributionPrefix;if(p===!1)return null;var x={position:"absolute",bottom:0,right:0,fontSize:"11px",padding:"2px 5px",background:"rgba(255, 255, 255, 0.7)",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif",color:"#333"},_={color:"#0078A8",textDecoration:"none"};return L.createElement("div",{key:"attr",className:"pigeon-attribution",style:x},g===!1?null:L.createElement("span",null,g||L.createElement("a",{href:"https://pigeon-maps.js.org/",style:_,target:"_blank",rel:"noreferrer noopener"},"Pigeon")," | "),p||L.createElement("span",null," \xA9 ",L.createElement("a",{href:"https://www.openstreetmap.org/copyright",style:_,target:"_blank",rel:"noreferrer noopener"},"OpenStreetMap")," contributors"))},d.renderWarning=function(){var l=this.props,p=l.metaWheelZoom,g=l.metaWheelZoomWarning,x=l.twoFingerDrag,_=l.twoFingerDragWarning,C=l.warningZIndex,T=this.state,M=T.showWarning,t=T.warningType,e=T.width,n=T.height;if(p&&g||x&&_){var a={position:"absolute",top:0,left:0,width:e,height:n,overflow:"hidden",pointerEvents:"none",opacity:M?100:0,transition:"opacity 300ms",background:"rgba(0,0,0,0.5)",color:"#fff",display:"flex",justifyContent:"center",alignItems:"center",fontSize:22,fontFamily:'"Arial", sans-serif',textAlign:"center",zIndex:C},i=typeof window<"u"&&window.navigator&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?"\u2318":"ctrl",s=t==="fingers"?_:g;return L.createElement("div",{className:"pigeon-overlay-warning",style:a},s.replace("META",i))}else return null},d.render=function(){var l=this.props,p=l.touchEvents,g=l.twoFingerDrag,x=this.state,_=x.width,C=x.height,T={width:this.props.width?_:"100%",height:this.props.height?C:"100%",position:"relative",display:"inline-block",overflow:"hidden",background:"#dddddd",touchAction:p?g?"pan-x pan-y":"none":"auto"},M=!!(_&&C);return L.createElement("div",{style:T,ref:this.setRef,dir:"ltr"},M&&this.renderTiles(),M&&this.renderOverlays(),M&&this.renderAttribution(),M&&this.renderWarning())},c}(Mt);r(nt,"defaultProps",{animate:!0,metaWheelZoom:!1,metaWheelZoomWarning:"Use META + wheel to zoom!",twoFingerDrag:!1,twoFingerDragWarning:"Use two fingers to move the map",zoomSnap:!0,mouseEvents:!0,touchEvents:!0,warningZIndex:100,animateMaxScreens:5,minZoom:1,maxZoom:18,limitBounds:"center",dprs:[],tileComponent:Wt});const Ot=()=>{const u=nt,c=gt(_t),d=wt((l,p,g,x)=>{const _=["a","b","c","d"],C=Math.floor(Math.random()*_.length),T=_[C],M=c==="light",t=`https://${T}.basemaps.cartocdn.com/light_all/${g}/${l}/${p}.webp`,e=`https://${T}.basemaps.cartocdn.com/dark_all/${g}/${l}/${p}.webp`;return M?t:e},[c]);return U("div",{role:"presentation",className:"map w-full h-screen",children:U(u,{defaultCenter:[6.244747,-75.574828],defaultZoom:11,provider:d,attribution:U("span",{children:"Pigeon Maps | CartoCDN Layers"}),attributionPrefix:!1,boxClassname:"opacity-50 w-full h-full"})})};export{Ot as default};
